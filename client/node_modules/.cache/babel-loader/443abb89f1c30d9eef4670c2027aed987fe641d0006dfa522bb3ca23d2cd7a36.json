{"ast":null,"code":"import{createContext,useContext,useEffect,useMemo,useState}from'react';import api from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem('token'));const[loading,setLoading]=useState(true);async function fetchCurrentUser(){try{const response=await api.get('/auth/me');setUser(response.data.user);return response.data.user;}catch(error){localStorage.removeItem('token');setToken(null);setUser(null);return null;}}useEffect(()=>{async function bootstrapAuth(){if(!token){setLoading(false);return;}await fetchCurrentUser();setLoading(false);}bootstrapAuth();},[token]);async function register(payload){const response=await api.post('/auth/register',payload);const nextToken=response.data.token;localStorage.setItem('token',nextToken);setToken(nextToken);setUser(response.data.user);return response.data.user;}async function login(payload){const response=await api.post('/auth/login',payload);const nextToken=response.data.token;localStorage.setItem('token',nextToken);setToken(nextToken);setUser(response.data.user);return response.data.user;}function logout(){localStorage.removeItem('token');setToken(null);setUser(null);}const value=useMemo(()=>({user,token,loading,register,login,logout,fetchCurrentUser}),[user,token,loading]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export function useAuth(){const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used inside AuthProvider');}return context;}","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","api","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","token","setToken","localStorage","getItem","loading","setLoading","fetchCurrentUser","response","get","data","error","removeItem","bootstrapAuth","register","payload","post","nextToken","setItem","login","logout","value","Provider","useAuth","context","Error"],"sources":["/home/cmdcmd007/projects/meal-planner/client/src/context/AuthContext.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport api from '../services/api';\n\nconst AuthContext = createContext(null);\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem('token'));\n  const [loading, setLoading] = useState(true);\n\n  async function fetchCurrentUser() {\n    try {\n      const response = await api.get('/auth/me');\n      setUser(response.data.user);\n      return response.data.user;\n    } catch (error) {\n      localStorage.removeItem('token');\n      setToken(null);\n      setUser(null);\n      return null;\n    }\n  }\n\n  useEffect(() => {\n    async function bootstrapAuth() {\n      if (!token) {\n        setLoading(false);\n        return;\n      }\n      await fetchCurrentUser();\n      setLoading(false);\n    }\n\n    bootstrapAuth();\n  }, [token]);\n\n  async function register(payload) {\n    const response = await api.post('/auth/register', payload);\n    const nextToken = response.data.token;\n    localStorage.setItem('token', nextToken);\n    setToken(nextToken);\n    setUser(response.data.user);\n    return response.data.user;\n  }\n\n  async function login(payload) {\n    const response = await api.post('/auth/login', payload);\n    const nextToken = response.data.token;\n    localStorage.setItem('token', nextToken);\n    setToken(nextToken);\n    setUser(response.data.user);\n    return response.data.user;\n  }\n\n  function logout() {\n    localStorage.removeItem('token');\n    setToken(null);\n    setUser(null);\n  }\n\n  const value = useMemo(\n    () => ({ user, token, loading, register, login, logout, fetchCurrentUser }),\n    [user, token, loading]\n  );\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used inside AuthProvider');\n  }\n  return context;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}